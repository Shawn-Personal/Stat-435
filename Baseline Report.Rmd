---
title: "Baseline Investigation"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE)
BaselineData <- read.csv("C:/Users/sjchs/OneDrive/Desktop/University Course/Stat 435/BaselineData.csv", fileEncoding="UTF-8-BOM")
```

# Stat 435: Baseline

## Question

The problem we are going to investigate is the baseline value of the WatFactory, more specially the y300 values.\newline
In order to get a evaluate of the performance of the solution for reduce variance in WatFactory, we first need to get a accurate understanding/measurement of the baseline outputs and variance of y300.\newline

## Plan

The plan is to collect in total 500 y300 part outputs in a 5 day period. We took measurements of 100 y300 output parts per day randomly for 5 days.\newline
We choose a 5 day period because WatFactory only works 5 days a week and 5 days is mostly likely enough data to determine if the days of the week contributes to any variance of y300.\newline
We also feel that 100 data per day spread out randomly will capture approximately equal data for all three shifts in a day, and it will enough to accurately represent y300 properties for the day.\newline
We feel that 500 y300 data gives about $\pm 6\%$ Relative Precision, which is enough Relative Precision to be an accurate representation for the true y300 properties (mean, variance, etc).\newline
We could have collected 1000 y300 data which will give a Relative Precision around $\pm 5\%$. However, we feel that because the cost of collecting 1000 y300 data is double of what it would cost for collecting 500 y30 data, and it does not reduce Relative Precision nearly as much (only $\pm 1\%$). The cost does not justify the benefit for collection 1000 y300 data instead of 500.\newline

## Data

```{r}
summary(BaselineData)
paste("The number of rows in this dataset is:", nrow(BaselineData))
```
From the R outputs, we see that we have 500 data points for y300 over 3 different shifts per day for a total of 5 days.\newline

## Analysis

```{r}
plot(BaselineData$y300, type = "b", ylab = "y300", xlab = "Obtained Order", main = "Run Chart")
```

```{r}
library(ggplot2)
shifts = factor(BaselineData$shift)
days = factor(BaselineData$daycount)
ggplot(BaselineData, aes(x=partnum, y=y300, colour=shifts, group=shifts)) + geom_line() + geom_point() + ggtitle("Run Chart Grouped by Shifts") + xlab("Part number") + ylab("y300")
```

```{r}
ggplot(BaselineData, aes(x=partnum, y=y300, colour=days, group=days)) + geom_line() + geom_point() + ggtitle("Run Chart Grouped by Days") + xlab("Part number") + ylab("y300")
```

```{r}
boxplot(BaselineData$y300, main = "Boxplot for y300")
abline(h=mean(BaselineData$y300))
text(x= 0.6, y= 3, labels= paste("Mean =", mean(BaselineData$y300)))
text(x= 1.4, y= 3, labels= paste("Median =", median(BaselineData$y300)))

my5cols <- c("#E7B800", "#2E9FDF", "#FC4E07", "#52854C", "#4E84C4", "#293352")
my3cols <- c("#E7B800", "#2E9FDF", "#FC4E07")

fun_mean <- function(x){
  return(data.frame(y=mean(x),label=mean(x,na.rm=T)))}

p1 <- ggplot(BaselineData, aes(x = shifts, y = y300))
bxp1 <- p1 + geom_boxplot(aes(color = shifts)) + stat_summary(fun = mean, geom="point",colour="darkred", size=3) +
stat_summary(fun.data = fun_mean, geom="text", vjust=-0.7) +
  scale_color_manual(values = my3cols)
bxp1

p2 <- ggplot(BaselineData, aes(x = days, y = y300))
bxp2 <- p2 + geom_boxplot(aes(color = days)) + stat_summary(fun = mean, geom="point",colour="darkred", size=3) +
stat_summary(fun.data = fun_mean, geom="text", vjust=-0.7) +
  scale_color_manual(values = my5cols)
bxp2

```

```{r}
rx = range(BaselineData$y300)
hist(BaselineData$y300, main = "Histogram for y300", probability = TRUE, breaks = seq(rx[1], rx[2], length.out = 25))
abline(v = mean(BaselineData$y300),                       # Add line for mean
       col = "red",
       lwd = 3)
```


```{r}
BaselineDataFactored = BaselineData
BaselineDataFactored$shift = factor(BaselineData$shift)
BaselineDataFactored$daycount = factor(BaselineData$daycount)
par(mfrow=c(1,3))
hist(BaselineData[BaselineData$shift == 1,]$y300, main = "Histogram for Shift 1", xlab = "y300", probability = TRUE, breaks = seq(rx[1], rx[2], length.out = 20))
abline(v = mean(BaselineData[BaselineData$shift == 1,]$y300),                       # Add line for mean
       col = "red",
       lwd = 1)
hist(BaselineData[BaselineData$shift == 2,]$y300, main = "Histogram for Shift 2", xlab = "y300", probability = TRUE, breaks = seq(rx[1], rx[2], length.out = 20))
abline(v = mean(BaselineData[BaselineData$shift == 2,]$y300),                       # Add line for mean
       col = "red",
       lwd = 1)
hist(BaselineData[BaselineData$shift == 3,]$y300, main = "Histogram for Shift 3", xlab = "y300", probability = TRUE, breaks = seq(rx[1], rx[2], length.out = 20))
abline(v = mean(BaselineData[BaselineData$shift == 3,]$y300),                       # Add line for mean
       col = "red",
       lwd = 1)
```

```{r}
par(mfrow=c(2,3))
hist(BaselineData[BaselineData$daycount == 1,]$y300, main = "Histogram for Day 1", xlab = "y300", xlim = c(-15, 15), probability = TRUE, breaks = seq(rx[1], rx[2], length.out = 15))
abline(v = mean(BaselineData[BaselineData$daycount == 1,]$y300),                       # Add line for mean
       col = "red",
       lwd = 1)
hist(BaselineData[BaselineData$daycount == 2,]$y300, main = "Histogram for Day 2", xlab = "y300", xlim = c(-15, 15), probability = TRUE, breaks = seq(rx[1], rx[2], length.out = 15))
abline(v = mean(BaselineData[BaselineData$daycount == 2,]$y300),                       # Add line for mean
       col = "red",
       lwd = 1)
hist(BaselineData[BaselineData$daycount == 3,]$y300, main = "Histogram for Day 3", xlab = "y300", xlim = c(-15, 15), probability = TRUE, breaks = seq(rx[1], rx[2], length.out = 15))
abline(v = mean(BaselineData[BaselineData$daycount == 3,]$y300),                       # Add line for mean
       col = "red",
       lwd = 1)
hist(BaselineData[BaselineData$daycount == 4,]$y300, main = "Histogram for Day 4", xlab = "y300", xlim = c(-15, 15), probability = TRUE, breaks = seq(rx[1], rx[2], length.out = 15))
abline(v = mean(BaselineData[BaselineData$daycount == 4,]$y300),                       # Add line for mean
       col = "red",
       lwd = 1)
hist(BaselineData[BaselineData$daycount == 5,]$y300, main = "Histogram for Day 5", xlab = "y300", xlim = c(-15, 15), probability = TRUE, breaks = seq(rx[1], rx[2], length.out = 15))
abline(v = mean(BaselineData[BaselineData$daycount == 5,]$y300),                       # Add line for mean
       col = "red",
       lwd = 1)
```


## Conclusion
